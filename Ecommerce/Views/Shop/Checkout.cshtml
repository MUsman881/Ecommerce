
@{
    ViewBag.Title = "Checkout";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<style>
    .row {
        display: -ms-flexbox; /* IE10 */
        display: flex;
        -ms-flex-wrap: wrap; /* IE10 */
        flex-wrap: wrap;
        margin: 0 -16px;
    }

    .error{
        color:red;
    }

    .mb-top {
        margin-top: 10px;
    }

    .cont {
        background-color: #f2f2f2;
        padding: 5px 20px 15px 20px;
        border: 1px solid lightgrey;
        border-radius: 3px;
    }


    input[type=text] {
        width: 100%;
        margin-bottom: 20px;
        padding: 12px;
        border: 1px solid #ccc;
        border-radius: 3px;
    }

    label {
        margin-bottom: 10px;
        display: block;
    }

    .icon-container {
        margin-bottom: 20px;
        padding: 7px 0;
        font-size: 24px;
    }



    .btn {
        padding: 12px;
        margin: 10px 0;
        width: 100%;
        border-radius: 3px;
        cursor: pointer;
        font-size: 17px;
    }



    hr {
        border: 1px solid lightgrey;
    }

    span.price {
        float: right;
        color: grey;
    }

    @@media(max-width: 800px) {
        .row {
            flex-direction: column-reverse;
        }

        .col-md-4 {
            margin-bottom: 20px;
        }
    }

    @@media(max-width:1000px) {
        .row {
            flex-direction: column-reverse;
        }

        .col-md-4 {
            margin-bottom: 20px;
        }
    }
</style>

<div class="container">
    <div class="text-center">
        <h2 style="margin:30px">Checkout Form</h2>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div class="container cont">

                @using (Html.BeginForm("Ordersuccess", "Shop", FormMethod.Post, new { id="customer-form" ,onsubmit = "return SubmitForm(this)" }))
                {
                    <div class="row">
                        <div class="col-md-12 mb-top ">
                            <h3 class="text-center">Billing Address</h3>
                            <label for="name"><i class="fa fa-user"></i> Full Name</label>
                            <input type="text" id="name" name="CustomerName" placeholder="John M. Doe">

                            <label for="number"><i class="fa fa-envelope"></i> Number</label>
                            <input type="text" id="number" name="CustomerPhone" placeholder="+92-0300-0000000">

                            <label for="address"><i class="fa fa-address-card-o"></i> Address</label>
                            <input type="text" id="adr" name="CustomerAddress" placeholder="542 W. 15th Street">

                            <label for="city"><i class="fa fa-institution"></i>City</label>
                            <input type="text" id="city" name="CustomerCity" placeholder="New York">

                            @*<div class="row">
                                <div class="col-md-6">
                                    <label for="state">State</label>
                                    <input type="text" id="state" name="state" placeholder="NY">
                                </div>
                                <div class="col-md-6">
                                    <label for="zip">Zip</label>
                                    <input type="text" id="zip" name="zip" placeholder="10001">
                                </div>
                            </div>*@
                        </div>

                        @*<div class="col-md-6 mb-top">
                                <h3>Payment</h3>
                                <label for="fname">Accepted Cards</label>
                                <div class="icon-container">
                                    <i class="fa fa-cc-visa" style="color:navy;"></i>
                                    <i class="fa fa-cc-amex" style="color:blue;"></i>
                                    <i class="fa fa-cc-mastercard" style="color:red;"></i>
                                    <i class="fa fa-cc-discover" style="color:orange;"></i>
                                </div>
                                <label for="cname">Name on Card</label>
                                <input type="text" id="cname" name="cardname" placeholder="John More Doe">
                                <label for="ccnum">Credit card number</label>
                                <input type="text" id="ccnum" name="cardnumber" placeholder="1111-2222-3333-4444">
                                <label for="expmonth">Exp Month</label>
                                <input type="text" id="expmonth" name="expmonth" placeholder="September">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label for="expyear">Exp Year</label>
                                        <input type="text" id="expyear" name="expyear" placeholder="2018">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="cvv">CVV</label>
                                        <input type="text" id="cvv" name="cvv" placeholder="352">
                                    </div>
                                </div>
                            </div>*@

                    </div>
                    @*<label>
                        <input type="checkbox" checked="checked" name="sameadr"> Shipping address same as billing
                    </label>*@
                    <input type="submit" value="Process Order" class="btn btn-primary">

                }
            </div>

        </div>

        @*<div class="col-md-4">
                <div class="container cont">
                    <h4 class="mb-top">Cart <span class="price" style="color:black"><i class="fa fa-shopping-cart"></i> <b>4</b></span></h4>
                    <p><a href="#">Product 1</a> <span class="price">$15</span></p>
                    <p><a href="#">Product 2</a> <span class="price">$5</span></p>
                    <p><a href="#">Product 3</a> <span class="price">$8</span></p>
                    <p><a href="#">Product 4</a> <span class="price">$2</span></p>
                    <hr>
                    <p>Total <span class="price" style="color:black"><b>$30</b></span></p>
                </div>
            </div>*@
    </div>
</div>



@section scripts{

    <script src="~/Scripts/jquery.mycart.js"></script>
<script src="~/Scripts/jquery.validate.js"></script>
<script src="~/Scripts/notify.min.js"></script>
    <script>

        $(document).ready(function () {


            $("#customer-form").validate({

                rules: {
                    CustomerName: {
                        required: true
                    },
                    CustomerPhone: {
                        required: true
                    },
                    CustomerAddress: {
                        required: true
                    },
                    CustomerCity: {
                        required: true
                    }
                }

            });

            var goToCartIcon = function ($addToCartBtn) {
                var $carticon = $(".my-cart-icon");
                var $image = $('<img width="30px" height="30px" src="' + $addToCartBtn.data("image") + '"/>').css({ "position": "fixed", "z-index": "999" });
                $addToCartBtn.prepend($image);
                var position = $carticon.position();
                $image.animate({
                    top: position.top,
                    left: position.left
                }, 500, "linear", function () {
                    $image.remove();
                });
            }

            $('.my-cart-btn').myCart({

                currencySymbol: 'Rs ',
                classCartIcon: 'my-cart-icon',
                classCartBadge: 'my-cart-badge',
                classProductQuantity: 'my-product-quantity',
                classProductRemove: 'my-product-remove',
                classCheckoutCart: 'my-cart-checkout',
                affixCartIcon: true,
                showCheckoutModal: true,
                numberOfDecimals: 2,

                clickOnAddToCart: function ($addTocart) {
                    goToCartIcon($addTocart);
                },
                afterAddOnCart: function (products, totalPrice, totalQuantity) {
                    console.log("afterAddOnCart", products, totalPrice, totalQuantity);
                },
                clickOnCartIcon: function ($cartIcon, products, totalPrice, totalQuantity) {
                    console.log("cart icon clicked", $cartIcon, products, totalPrice, totalQuantity);
                },
                //checkoutCart: function(products, totalPrice, totalQuantity) {
                //    var checkoutString = "Total Price: " + totalPrice + "\nTotal Quantity: " + totalQuantity;
                //    checkoutString += "\n\n id \t name  \t price \t quantity \t image path";
                //    $.each(products, function(){
                //        checkoutString += ("\n " + this.id + " \t " + this.name + " \t " + this.price + " \t " + this.quantity + " \t " + this.image);
                //    });
                //    alert(checkoutString)
                //    console.log("checking out", products, totalPrice, totalQuantity);
                //}

            });


            function SubmitForm(form) {

                $.ajax({
                    type: "POST",
                    url: form.action,
                    data: $(form).serialize(),
                    success: function (data) {
                        if (data.success) {

                            $('#name').val("");
                            $('#number').val("");
                            $("#adr").val("");
                            $("#city").val("");

                            $.notify(data.message, {
                                globalPosition: "top center",
                                className: "success"
                            });
                        }
                    }

                });

                return false;

            }


        });

    </script>

}